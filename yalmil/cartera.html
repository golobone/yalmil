<!DOCTYPE html>
<!-- saved from url=(0032)https://yalmil.pages.dev/cartera -->
<html lang="es"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cartera | Lunas</title>

  <link rel="icon" href="https://cdn.discordapp.com/emojis/1416607460201857168.png?v=1" type="image/png">
  <meta property="og:title" content="Yalmil.com">
  <meta property="og:description" content="Cartera de Lunas del usuario">
  <meta property="og:image" content="https://cdn.discordapp.com/attachments/1355008732576088204/1402309070014124102/Screenshot_20250804-221210.png">
  <meta property="og:url" content="https://yalmil.github.io/Yalmil.com/">
  <meta property="og:type" content="website">

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap');
    *{ box-sizing:border-box; margin:0 }

    body{
      font-family:'Poppins',sans-serif;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:flex-start;
      min-height:100vh;
      padding:20px;
      animation:fade .6s ease-out;
    }

    @keyframes fade { from{opacity:0; transform:translateY(10px)} to{opacity:1; transform:translateY(0)} }

    @media(prefers-color-scheme:dark){
      body{background:linear-gradient(135deg,#0a0a0a,#1a001f);color:#e5ccff}
      .card, .shop-item{background:rgba(40,0,60,.25);border:2px solid #c084fc}
      h2{color:#c084fc}
    }

    @media(prefers-color-scheme:light){
      body{background:linear-gradient(135deg,#330a00,#662000);color:#ffd8a6}
      .card, .shop-item{background:rgba(60,20,0,.2);border:2px solid #ff8c00}
      h2{color:#ff8c00}
    }

    .card{
      padding:2rem;
      width:90%;
      max-width:380px;
      border-radius:20px;
      text-align:center;
      backdrop-filter:blur(8px);
      margin-bottom:20px;
    }

    .lunas{
      font-size:2.6rem;
      font-weight:700;
      margin-top:1rem;
      text-shadow:0 0 10px currentColor;
    }

    button{
      margin-top:1rem;
      padding:10px 14px;
      border-radius:10px;
      border:none;
      cursor:pointer;
      font-weight:600;
    }

    /* Tienda */
    .shop{
      width:100%;
      max-width:450px;
    }

    .shop h2{
      text-align:center;
      margin-bottom:10px;
    }

    .shop-item{
      padding:15px;
      border-radius:18px;
      margin-bottom:15px;
      backdrop-filter:blur(6px);
    }

    .shop-item-title{
      font-size:1.2rem;
      font-weight:600;
      margin-bottom:5px;
    }

    .shop-item button{
      margin-top:10px;
      width:100%;
    }

  </style>
</head>

<body>

  <div class="card">
    <h2>Tu cartera</h2>
    <p>Lunas actuales</p>
    <div class="lunas" id="lunas">0</div>

    <button id="logoutBtn">Cerrar sesión</button>
  </div>

  <div class="shop">
    <h2>Tienda / Canjear lunas</h2>

      <div class="shop-item" data-price="800">
      <div class="shop-item-title">100 Robux</div>
      <p>Precio: 800 lunas</p>
      <button class="buy-btn">Canjear</button>
    </div>

      <div class="shop-item" data-price="1200">
      <div class="shop-item-title">Discord nitro (mes)</div>
      <p>Precio: 1200 lunas</p>
      <button class="buy-btn">Canjear</button>
    </div>

    
    <div class="shop-item" data-price="3500">
    <div class="shop-item-title">Juego de 10 dólares (steam)</div>
    <p>Precio: 3500 lunas</p>
    <button class="buy-btn">Canjear</button>
    </div>

        <div class="shop-item" data-price="3500">
    <div class="shop-item-title">Juego de 10 dólares (playstore/appstore)</div>
    <p>Precio: 3500 lunas</p>
    <button class="buy-btn">Canjear</button>
        </div>

        <div class="shop-item" data-price="1200">
    <div class="shop-item-title">Google gamepass (Android)</div>
    <p>Precio: 1200</p>
    <button class="buy-btn">Canjear</button>
        </div>

  </div>


<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
  import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js";
  import { getDatabase, ref, onValue, set, get } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAZoRcoeC3MFMPYJWgl4dmNjq-U51dKD5o",
    authDomain: "databaseloginweb.firebaseapp.com",
    databaseURL: "https://databaseloginweb-default-rtdb.firebaseio.com",
    projectId: "databaseloginweb",
    storageBucket: "databaseloginweb.firebasestorage.app",
    messagingSenderId: "121538864529",
    appId: "1:121538864529:web:e92aaeaa4ba52618162630"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getDatabase(app);

  const lunasBox = document.getElementById("lunas");
  const logoutBtn = document.getElementById("logoutBtn");

  let userUID = null;
  let lunasActuales = 0;

  onAuthStateChanged(auth, async (user) => {
    if (!user) {
      window.location.href = "login.html";
      return;
    }

    userUID = user.uid;
    const lunaRef = ref(db, "users/" + userUID + "/lunas");

    // 1. Revisa si existe el nodo (NO lo sobreescribe si ya existe)
    const snap = await get(lunaRef);

    if (!snap.exists()) {
      // Primera vez -> crear nodo
      await set(lunaRef, 0);
      lunasActuales = 0;
      lunasBox.textContent = 0;
    }

    // 2. Sincronizar siempre
    onValue(lunaRef, (s) => {
      lunasActuales = s.val();
      lunasBox.textContent = lunasActuales;
    });
  });

  logoutBtn.addEventListener("click", async () => {
    await signOut(auth);
    window.location.href = "login.html";
  });

  // Comprar
  const botones = document.querySelectorAll(".buy-btn");

  botones.forEach(btn => {
    btn.addEventListener("click", () => {
      const item = btn.parentElement;
      const precio = parseInt(item.dataset.price);

      if (lunasActuales >= precio) {
        const nuevaCantidad = lunasActuales - precio;
        set(ref(db, "users/" + userUID + "/lunas"), nuevaCantidad);
        window.location.href = "https://discord.com/users/1282532222305308682";
      } else {
        alert("No tienes suficientes lunas!");
      }
    });
  });
</script>



</body></html>